#
#   esp.conf -- Extended Embedded Server Pages compiler commands
#   

#
#   Default compilation command. Overridden below for some operating systems.
#   This is used for MACOSX, LINUX, FREEBSD and other GCC compilers
#
#   -mtune=${ARCH}
#
EspCompile cc -shared ${DEBUG} -Wall -Wno-unused-result -DPIC -fPIC -I${INC} -L${LIBDIR} -Wl,--enable-new-dtags -Wl,-rpath,$ORIGIN/ -Wl,-rpath,$ORIGIN/../lib ${LIBDIR}/mod_esp${SHOBJ} -lappweb -o ${OUT}${SHOBJ} ${SRC}

<if WIN>
    EspCompile cl -LD ${DEBUG} -D_REENTRANT -D_MT -nologo -GR- -W3 -MDd -I${INC} -Fe${OUT}${SHOBJ} ${SRC} ${LIBDIR}\mod_esp${SHLIB} ${LIBDIR}\libappweb.lib ws2_32.lib
    EspEnv INCLUDE "C:\Program Files\Microsoft Visual Studio 10.0\VC\INCLUDE;C:\Program Files\Microsoft SDKs\Windows\v7.1\include"
    EspEnv LIB "C:\Program Files\Microsoft SDKs\Windows\v7.1\LIB;C:\Program Files\Microsoft Visual Studio 10.0\VC\lib"
    EspEnv PATH "C:\Program Files\Microsoft Visual Studio 10.0\Common7\IDE;C:\Program Files\Microsoft Visual Studio 10.0\VC\bin;C:\Program Files\Microsoft Visual Studio 10.0\Common7\Tools;C:\Program Files\Microsoft Visual Studio 10.0\SDK\v3.5\bin;C:\Program Files\Microsoft Visual Studio 10.0\VC\VCPackages;C:\Program Files\Microsoft SDKs\Windows\v7.1\bin"

</if>

<if MACOSX>
    #
    #   Mac gcc requires a separate compile and link to get debug symbols. If debug is not required, use the one-step
    #   compile command below.
    #
    EspCompile cc -c ${DEBUG} -Wall -DPIC -fPIC -arch ${ARCH} -I${INC} ${SRC} -o ${OBJ}
    EspLink cc -dynamiclib -arch ${ARCH} -L${LIBDIR} -Wl,-rpath,@executable_path/../lib -Wl,-rpath,@executable_path/ -Wl,-rpath,@loader_path/ ${LIBDIR}/mod_esp${SHOBJ} -lappweb -lpcre -lhttp -lmprssl -lmpr -lpthread -lm -o ${OUT}${SHOBJ} ${OBJ} 
    #
    # EspCompile cc -dynamiclib ${DEBUG} -Wall -DPIC -fPIC -arch ${ARCH} -I${INC} -L${LIBDIR} -Wl,-rpath,@executable_path/../lib -Wl,-rpath,@executable_path/ -Wl,-rpath,@loader_path/ ${LIBDIR}/mod_esp${SHOBJ} -lappweb -lpcre -lhttp -lmprssl -lmpr -lpthread -lm -o ${OUT}${SHOBJ} ${SRC} 
</if>

<if VXWORKS>
    EspCompile cc -shared ${DEBUG} -Wall -Wno-unused-result -DPIC -fPIC -mtune=${ARCH} -I${INC} -L${LIBDIR} -Wl,--enable-new-dtags -Wl,-rpath,$ORIGIN/ -Wl,-rpath,$ORIGIN/../lib ${LIBDIR}/mod_esp${SHOBJ} -lappweb -o ${OUT}${SHOBJ} ${SRC} 
</if>

#
#   Use this style to run a script to compile. The script would look like:
#
#    #!/bin/bash
#    for f in $* ; do
#        eval $f
#    done
#    cc -c ${DEBUG} -Wall -DPIC -fPIC -arch ${ARCH} -I${INC} ${SRC} 
#    cc -dynamiclib ${DEBUG} -L${LIBDIR} -Wl,-rpath,@executable_path/../lib -Wl,-rpath,@executable_path/ -Wl,-rpath,@loader_path/ ${LIBDIR}/mod_esp${SHOBJ} -lappweb -lpcre -lhttp -lmprssl -lmpr -lpthread -lm -o ${OUT}${SHOBJ} ${OBJ} 
#    rm -f ${OBJ}
#    exit 0

<if SCRIPT>
    # EspCompile script DEBUG="${DEBUG}" ARCH="${ARCH}" INC="${INC}" LIBDIR="${LIBDIR}" OBJ="${OBJ}" OUT="${OUT}" SRC="${SRC}" SHOBJ="${SHOBJ}"
</if>
