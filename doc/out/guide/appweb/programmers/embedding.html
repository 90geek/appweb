<!DOCTYPE html>
<html lang="en">
<head>
    <title>Embedding</title>
    <!-- Copyright Embedthis Software, LLC, 2003-2014. All Rights Reserved. -->
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0">
    <meta name="keywords" content="embedded web server, web server software, embedded HTTP, application web server,
        embedded server, small web server, HTTP server, library web server, library HTTP, HTTP library" />
    <meta name="description" content="Embedthis Sofware provides commercial and open source embedded web servers for
        devices and applications." />
    <link href='http://fonts.googleapis.com/css?family=Source+Sans+Pro:400,+Sans:300italic,400,300,700'
        rel='stylesheet' type='text/css'>
    <link href="/lib/semantic/packaged/css/semantic.css" rel="stylesheet" type="text/css" />
    <link href="/css/all.css" rel="stylesheet" type="text/css" />
    <link href="/images/favicon.ico" rel="shortcut icon" />

</head>
<body>
        
    <div class="ui large left vertical inverted labeled overlay sidebar menu">
        <div class="item">
            <a href="../../../">
                <b>General</b>
            </a>
            <div class="menu">
                <a class="item" href="../../../index.html">Appweb Overview</a>
                <a class="item" href="../../../guide/appweb/features.html">Appweb Features</a>
                <a class="item" href="../../../product/releaseNotes.html">Release Notes</a>
                <a class="item" href="https://github.com/embedthis/appweb/releases">Change Log</a>
                <a class="item" href="https://github.com/embedthis/appweb/milestones">Roadmap</a>
                <a class="item" href="https://embedthis.com/download/appweb.html">Download</a> 
                <a class="item" href="../../../product/compatibility.html">Compatibility</a>
                <a class="item" href="../../../licenses/index.html">Licensing</a>
            </div>
        </div>
        <div class="item">
            <a href="../../../guide/appweb/users/gettingStarted.html">
                <b>Getting Started</b>
            </a>
            <div class="menu">
                <a class="item" href="../../../guide/appweb/users/quickStart.html">Quick Start</a>
                <a class="item" href="../../../product/install/index.html">Installation</a>
                <a class="item" href="../../../guide/appweb/users/faq.html">Appweb FAQ</a>
                <a class="item" href="../../../guide/appweb/users/starting.html">Starting and Stopping</a>
                <a class="item" href="../../../guide/appweb/users/service.html">Running as a Service</a>
            </div>
        </div>
        <div class="item">
            <a href="../../../guide/appweb/users/index.html"><b>Users Guide</b></a>
            <div class="menu">
                <a class="item" href="../../../guide/appweb/users/configuration.html">Configuring Appweb</a>
                <a class="item" href="../../../guide/appweb/users/configuration.html#directives">Configuration Directives</a>
                <a class="item" href="../../../guide/appweb/users/frameworks.html">Web Frameworks</a>
                <a class="item" href="../../../guide/appweb/users/modules.html">Using Loadable Modules</a>
                <a class="item" href="../../../guide/appweb/users/ports.html">Ports and Binding</a>
                <a class="item" href="../../../guide/appweb/users/routing.html">Routing Requests</a>
                <a class="item" href="../../../guide/appweb/users/stages.html">Request Pipeline</a>
                <a class="item" href="../../../guide/appweb/users/lang.html">Multi-Language Content</a>
                <a class="item" href="../../../guide/appweb/users/authentication.html">User Authorization</a>
                <a class="item" href="../../../guide/appweb/users/logFiles.html">Logging</a>
                <a class="item" href="../../../guide/appweb/users/caching.html">Caching</a>
                <a class="item" href="../../../guide/appweb/users/vhosts.html">Virtual Hosts</a>
                <a class="item" href="../../../guide/appweb/users/ssl.html">Secure Sockets (SSL)</a>
                <a class="item" href="../../../guide/appweb/users/client.html">Http Client</a>
                <a class="item" href="../../../guide/appweb/users/security.html">Security Considerations</a>
                <a class="item" href="../../../guide/appweb/users/monitor.html">Monitoring and Defending</a>
                <a class="item" href="../../../guide/appweb/users/uploading.html">File Upload</a>
                <a class="item" href="../../../guide/appweb/users/webSockets.html">WebSockets</a>
            </div>
        </div>
        <div class="item">
            <a href="../../../guide/appweb/programmers/index.html">Programmer Guide</a>
            <div class="menu">
                <a class="item" href="../../../guide/appweb/programmers/embedding.html">Embedding Appweb</a>
                <a class="item" href="../../../guide/appweb/programmers/modules.html">Creating Appweb Modules</a>
                <a class="item" href="../../../guide/appweb/programmers/handlers.html">Creating Appweb Handlers</a>
                <a class="item" href="../../../guide/appweb/programmers/stages.html">Creating Pipeline Stages</a>
                <a class="item" href="../../../guide/appweb/programmers/migrating.html">Migrating to Appweb 5</a>
                <a class="item" href="../../../guide/appweb/programmers/rom.html">Serving Pages from ROM</a>
                <a class="item" href="../../../guide/appweb/programmers/man.html">Man Pages</a>
            </div>
        </div>
        <div class="item">
            <a href="../../../ref/appweb/index.html">Reference Guide</a>
            <div class="menu">
                <a class="item" href="../../../ref/appweb/native.html">API Library</a>
                <a class="item" href="../../../ref/appweb/memory.html">Appweb Memory Allocation</a>
                <a class="item" href="../../../ref/appweb/multithread.html">Multithreaded Programming</a>
                <a class="item" href="../../../ref/appweb/architecture.html">Appweb Architecture</a>
                <a class="item" href="../../../guide/appweb/standards/http.html">HTTP References</a>
            </div>
        </div>
        <div class="item">
            <a href="../../../guide/appweb/source/index.html">Source Code</a>
            <div class="menu">
                <a class="item" href="../../../guide/appweb/source/building.html">Building Appweb from Source</a>
                <a class="item" href="../../../guide/appweb/source/porting.html">Porting to New Platforms</a>
            </div>
        </div>
        <div class="item">
            <a href="../../../product/project.html">Project Resources</a>
            <div class="menu">
                <a class="item" href="https://github.com/embedthis/appweb">Source Code Repository</a>
                <a class="item" href="https://github.com/embedthis/appweb/issues">Project Issue Database</a>
                <a class="item" href="https://embedthis.com/scripts/contributors.esp">Contributors Agreement</a>
            </div>
        </div>
        <div class="item">
            <b>Links</b>
            <div class="menu">
                <a class="item" href="http://goo.gl/dGRDl4">Official Appweb News (Google+)</a>
                <a class="item" href="http://groups.google.com/group/appweb">Appweb Community Support</a>
                <a class="item" href="https://embedthis.com/">Embedthis Web Site</a>
                <a class="item" href="https://embedthis.com/appweb/">Appweb Web Site</a>
                <a class="item" href="https://embedthis.com/blog/">Embedthis Blog</a>
                <a class="item" href="http://twitter.com/mobstream">Twitter</a>
            </div>
        </div>
    </div>

    <div class="ui inverted masthead">
                <div class="column">
            <div class="inverted secondary pointing ui menu">
                <div class="header left item">
                    <!-- <a href="/index.html"><img src="/images/embedthis.png"></a> -->
                    <a href="/index.html">Appweb Documentation</a>
                </div>
                <div class="right menu">
                    <div class="ui top right">
                        <a class="item active" href="../../..//index.html">Documentation</a>
                        <a class="item" href="https://embedthis.com/appweb/">Appweb</a>
                        <a class="item" href="https://github.com/embedthis/appweb">Repository</a>
                        <a class="item" href="http://groups.google.com/group/appweb">Support</a>
                    </div>
                </div>
            </div>
            <div class="ui breadcrumb">
                <a class="section" href="../../../">Home</a>
                
                <div class="divider">/</div>
                <a class="section " href="index.html">
                    Programmers Guide
                </a>
                
                <div class="divider">/</div>
                <a class="section active" href="embedding.html">
                    Embedding
                </a>
                
            </div>
        </div>
        <div class="ui black small launch right attached toggle button" style="width: 40px;">
            <i class="icon list layout">
                <span class="text" style="display: none;">Menu</span>
            </i>
        </div>

    </div>
    <div class="content">
<h1 class="title">Embedding Appweb</h1>
            <p>When extending and embedding Appweb in your application or system, you have three options:</p>
            <ol>
                <li>Use the existing Appweb main program and extend Appweb via a loadable module.</li>
                <li>Use the existing Appweb main program and extend Appweb via the ESP web framework.</li>
                <li>Link the Appweb HTTP library with your application main program.</li>
            </ol><a id="loadable"></a>
            <h2>Extending via a Loadable Module</h2>
            <p>You can extend the Appweb server program by creating an Appweb loadable module. You do this by creating
            a shared library that contains your application and some Appweb module interface code. This module is then
            specified in the Appweb configuration file so that the Appweb program will load it. It requires about 10
            lines of code to create an Appweb module.</p>
            <h2>Extending via ESP</h2>
            <p>The Embedded Server Pages (ESP) web framework allows the direct embedding of "C" language code in
            HTML web pages. This is the easiest way to invoke "C" APIs in your program. ESP also supports the loading
            of Model/View/Controller (MVC-based) applications. ESP will compile and load controller source code. Controllers
            provide an easy and efficient way to invoke "C" code when requests are made to certain URIs.</p>
            <h2>Embed the Appweb Library</h2>
            <p>You can link the Appweb library with your application to enable it to listen for HTTP requests and thus
            become a HTTP server itself. Embedding the Appweb library is easy and can be done with as little as one
            line of code.</p>
            
            <a id="appwebProgram"></a>
            <h2 class="section">The Appweb Server Program</h2>
            <p>The Appweb product includes a fully-featured HTTP server program that uses the Appweb HTTP library. This
            server (called <b>appweb</b>) is run by default when you install the Appweb binary distribution or run
            "make install" after building from source.</p>
            <p>The Appweb server program is ideal for embedded systems as it offers the following features:</p>
            <ul>
                <li>High performance</li>
                <li>Extendable via loadable modules</li>
                <li>Deterministic memory footprint and CPU loads</li>
                <li>Configurable sandbox limits that control memory usage</li>
                <li>Monitored and managed by the Appweb manager process</li>
            </ul>
            
            <a id="module"></a>
            <h2 class="section">Creating a Module</h2>
            <p>You can extend the Appweb program by creating a loadable module for your application code.</p>
            <p>To initialize your module and register with Appweb, you must create an initialization function that is
            called when Appweb loads your module. This must be named according to the form:</p>
            <pre class="ui code segment">
ma<b>Name</b>ModuleInit(MaHttp *http)
</pre>
            <p>Where <b>Name</b> is the name of your module.</p>
            <p>This initialization function must call the <b>mprCreateModule</b> API to register with Appweb.</p>
            <pre class="ui code segment">
int mprSimpleModuleInit(Http *http, MprModule *module)
{
    /* Put custom code here */
    return 0;
}
</pre>
            <p>See <a href="modules.html">Creating Appweb Modules</a> for more details.</p><a id="library"></a>
            <h2 class="section">Embed the Appweb Library</h2>
            <p>You can link the Appweb HTTP library with your main program to enable it to function as a HTTP
            server itself. This is ideal if your application is large and/or has a complex I/O, eventing or threading
            paradigm.</p>
            <h3>Linking with the Appweb Library</h3>
            <p>To include the Appweb library in your program you need to do the following things:</p>
            <ol>
                <li>Add <b>#include "appweb/appweb.h"</b> to the relevant source files.</li>
                <li>Add the Appweb library to your Makefiles or Windows project files. This will mean adding
                    libappweb.dll on Windows or libappweb.so on Unix.</li>
                <li>Use one of the embedding APIs to create the HTTP server.</li>
            </ol>
            <h3>One Line Embedding</h3>
            <p>The following code demonstrates the one-line Appweb embedding API. This will create and configure a web
            server based on the "server.conf" configuration file.</p>
            <pre class="ui code segment">
#include "appweb/appweb.h"
int main(int argc, char** argv)
{
    return maRunWebServer("server.conf");
}
</pre>
            <p>To build this sample and link with the Appweb library:</p>
            <pre class="ui code segment">
cc -o server server.c -lappweb
</pre>
            <h3>Full Control API</h3>
            <p>The Appweb library also provides a lower level embedding interface where you can precisely control how
            the web server is created and configured. This API also exposes the inner event and threading
            mechanisms.</p>
            <p>This example creates a web server using the "server.conf" configuration file and will service events
            until terminated.</p>
            <pre class="ui code segment">
#include "appweb/appweb.h"
int main(int argc, char **argv)
{
    Mpr         *mpr;
    MaServer    *server;
    MaAppweb    *appweb;
    /*
     *  Initialize and start the portable runtime services.
     */
    if ((mpr = mprCreate(0, NULL, 0)) == 0) {
        mprError("Can't create the web server runtime");
        return 0;
    }
    if (mprStart() &lt; 0) {
        mprError("Can't start the web server runtime");
        return 0;
    }
    appweb = maCreateAppweb(mpr);
    mprAddRoot(appweb);
    if ((server = maCreateServer(appweb, 0)) == 0) {
        mprError("Can't create the web server");
        return 0;
    }
    if (maParseConfig(server, "server.conf") &lt; 0) {
        mprError("Can't parse the config file %s", "server.conf");
        return 0;
    }
    if (maStartServer(server) &lt; 0) {
        mprError("Can't start the web server");
        return MPR_ERR_CANT_CREATE;
    }
    mprServiceEvents(-1, 0);
    maStopServer(server);
    mprRemoveRoot(appweb);
    mprDestroy(MPR_EXIT_DEFAULT);
    return 0;
}
</pre>
            <h3>More Details</h3>
            <p>For more details about the embedding API, please consult the <a href="../../../ref/appweb/api/appweb.html">Appweb
            API</a> and the <a href="../../../ref/appweb/native.html">Native APIs</a>.</p>
    </div>
    <div class="ui basic center aligned segment" id="terms">
        <p>&copy; Embedthis Software, 2003-2014. All rights reserved.
            Generated on Aug 14, 2014.
        </p>
    </div>

    <script src="/lib/jquery/jquery.js"></script>
    <script src="/lib/semantic/packaged/javascript/semantic.js"></script>
    <script>
        $('.sidebar').sidebar({overlay: false}).sidebar('toggle');
        $('.sidebar').first().sidebar('attach events', '.toggle.button');
    </script>
</body>
</html>
