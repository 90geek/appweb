<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<!-- BeginDsi "dsi/head.html" -->
<!DOCTYPE html>
<html lang="en">
<head>
    <title>Embedthis Appweb 4.0.0 Documentation</title>
    <meta name="keywords" content="embedded web server, web server software, embedded HTTP, application web server, 
        embedded server, small web server, HTTP server, library web server, library HTTP, HTTP library" />
    <meta name="description" content="Embedthis Sofware provides commercial and open source embedded web servers for 
        devices and applications." />
	<meta name="robots" content="index,follow" />
	<link href="../../../doc.css" rel="stylesheet" type="text/css" />
	<link href="../../../print.css" rel="stylesheet" type="text/css" media="print"/>
    <!--[if IE]>
    <link href="../../../iehacks.css" rel="stylesheet" type="text/css" />
    <![endif]-->
</head>

<body>
    <div class="top">
        <a class="logo" href="http://appwebserver.org/">&nbsp;</a>
        <div class="topRight">
             <div class="search">
                 <form method="get" action="http://www.google.com/search" title="Search appwebserver.org">
                     <p>
                        <label title="Search">Search</label> 
                        <input type="text" id="q" name="q" size="15" maxlength="255" />
                        <input type="submit" id="submit" value="Go" /> 
                        <input type="hidden" name="domains" value="appwebserver.org" /> 
                        <input type="hidden" name="sitesearch" value="appwebserver.org" />
                    </p>
                 </form>
              </div>
            <!--TITLE-->Embedthis Appweb 4.0.0
        </div>
        <div class="crumbs">
            <a href="../../../product/index.html">Home</a>
<!-- EndDsi -->
             &gt;<a href="index.html">ESP Guide</a>&gt; <b>Application Generator</b>
        </div>
    </div>
    <div class="content">
        <div class="contentRight">
            <h2>Quick Nav</h2>
            <ul>
                <li><a href="#app">Generating Applications</a></li>
                <li><a href="#controllers">Generating Controllers</a></li>
                <li><a href="#models">Generating Models</a></li>
                <li><a href="#scaffolds">Generating Scaffolds</a></li>
                <li><a href="#migrations">Generating Migrations</a></li>
                <li><a href="#runMigrations">Running Migrations</a></li>
                <li><a href="#compiling">Compiling</a></li>
                <li><a href="#running">Running</a></li>
                <li><a href="#cleaning">Cleaning</a></li>
                <li><a href="#options">Command Options</a></li>
            </ul>
<!-- BeginDsi "dsi/espSeeAlso.html" -->
		        <h2>See Also</h2>
		        <ul>
		          <li><a href="../../../../../../guide/appweb/esp/espTour.html">ESP Tour</a></li>
		          <li><a href="../../../../../../guide/appweb/esp/mvc.html">Model-View-Controller</a></li>
		          <li><a href="../../../../../../guide/appweb/esp/generator.html">Application Generator</a></li>
		          <li><a href="../../../../../../guide/appweb/esp/controllers.html">Controllers and Actions</a></li>
		          <li><a href="../../../../../../guide/appweb/esp/views.html">Views and Layouts</a></li>
		          <li><a href="../../../../../../guide/appweb/esp/controls.html">Ajax View Controls</a></li>
		          <li><a href="../../../../../../guide/appweb/esp/models.html">Database Models</a></li>
		          <li><a href="../../../../../../guide/appweb/esp/hosting.html">Hosting in Web Servers</a></li>
		        </ul>
<!-- EndDsi -->
        </div>
        <div class="contentLeft">
            <h1>Application Generator &mdash; esp</h1>
            <p>ESP provides an application generator and manager, called <b>esp</b>. This tool makes it easier
            and quicker to create and manage your web applications. The <b>esp</b> command generates ESP web
            applications, database migrations, database models, scaffolds and views.</p>
            <p>Ejsweb will create directories and generate configuration and source code files which can then be
            manually edited as required. Ejsweb is intelligent and will not overwrite existing files, so you can safely
            edit and regenerate without losing your changes. You can overwrite your changes if you wish to by using the
            <b>--overwrite</b> switch.</p>
            <p>Ejsweb can also be used to run your application by invoking a configured web server.</p><a name="app"
            id="app"></a>
            <h2 class="section">Generating Applications</h2>
            <p>To start a new web application, run <b>esp</b> to create the application directory and generate the
            essential application configuration and script files. For example:</p>
            <pre>
esp generate app myApp
</pre>
            <h3>Created Directories</h3>
            <p>This will create the following directories. Most of these directories are initially empty, but may be
            used over time. ESP follows conventions where specific files are stored. This greatly simplifies
            configuring a web application.</p>
            <table summary="Directories" width="100%">
                <thead>
                    <tr>
                        <td>Directory</td>
                        <td>Purpose</td>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>.tmp</td>
                        <td>Temporary working directory</td>
                    </tr>
                    <tr>
                        <td>.ejs</td>
                        <td>State files used by esp</td>
                    </tr>
                    <tr>
                        <td>bin</td>
                        <td>Programs and scripts</td>
                    </tr>
                    <tr>
                        <td>config</td>
                        <td>Configuration files</td>
                    </tr>
                    <tr>
                        <td>controllers</td>
                        <td>Controller source</td>
                    </tr>
                    <tr>
                        <td>db</td>
                        <td>Databases and scripts</td>
                    </tr>
                    <tr>
                        <td>db/migrations</td>
                        <td>Database migration scripts</td>
                    </tr>
                    <tr>
                        <td>doc</td>
                        <td>Documentation for the application</td>
                    </tr>
                    <tr>
                        <td>logs</td>
                        <td>Log files</td>
                    </tr>
                    <tr>
                        <td>models</td>
                        <td>Database model code</td>
                    </tr>
                    <tr>
                        <td>messages</td>
                        <td>Internationalization messages</td>
                    </tr>
                    <tr>
                        <td>test</td>
                        <td>Unit tests</td>
                    </tr>
                    <tr>
                        <td>src</td>
                        <td>Extra application source code</td>
                    </tr>
                    <tr>
                        <td>utils</td>
                        <td>Program utilities</td>
                    </tr>
                    <tr>
                        <td>views</td>
                        <td>View source files</td>
                    </tr>
                    <tr>
                        <td>views/layouts</td>
                        <td>View layout files</td>
                    </tr>
                    <tr>
                        <td>web</td>
                        <td>Public web directory</td>
                    </tr>
                    <tr>
                        <td>web/images</td>
                        <td>Public images</td>
                    </tr>
                    <tr>
                        <td>web/js</td>
                        <td>Client side JavaScripts</td>
                    </tr>
                    <tr>
                        <td>web/themes</td>
                        <td>Application HTML themes</td>
                    </tr>
                </tbody>
            </table>
            <p>Ejsweb will also create some files which have the following meaning:</p>
            <table summary="Files" width="100%">
                <thead>
                    <tr>
                        <td>Files</td>
                        <td>Purpose</td>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>config/config.ecf</td>
                        <td>Application configuration file</td>
                    </tr>
                    <tr>
                        <td>config/compiler.ecf</td>
                        <td>Compiler configuration file</td>
                    </tr>
                    <tr>
                        <td>config/database.ecf</td>
                        <td>Database configuration file</td>
                    </tr>
                    <tr>
                        <td>config/view.ecf</td>
                        <td>View connector configuration file</td>
                    </tr>
                    <tr>
                        <td>web/themes/default.css</td>
                        <td>Default theme CSS file</td>
                    </tr>
                    <tr>
                        <td>web/layout.css</td>
                        <td>Default layout CSS file</td>
                    </tr>
                    <tr>
                        <td>controllers/Application.es</td>
                        <td>Application base controller class</td>
                    </tr>
                    <tr>
                        <td>views/layouts/default.ejs</td>
                        <td>Default layout web page</td>
                    </tr>
                    <tr>
                        <td>README</td>
                        <td>Documentation explaining these files and directories</td>
                    </tr>
                </tbody>
            </table><a name="controllers" id="controllers"></a>
            <h2 class="section">Generating Controllers</h2>
            <p>Controllers are the primary mechanism for responding to client requests. To generate a controller:</p>
            <pre>
esp generate controller NAME [actions...]
</pre>
            <p>This will create the named controller in the <tt>controllers</tt> directory. A controller manages the
            web application and the controller action methods are invoked by ESP to respond to client requests and
            generate responses.</p>
            <p>If no actions are requested, esp will create a default <tt>index</tt> action method. If other actions
            are requested, esp will create an empty action method for each requested action. You can edit the
            controller source to meet your needs.</p>
            <p>If you use the command:</p>
            <pre>
esp generate controller Admin edit login logout command.
</pre>The following controller code will be generated.
            <pre>
public class AdminController extends BaseController {
    function AdminController() { 
    }
    action function edit() {
    }
    action function login() {
    }
    action function logout() {
    }
}
</pre><a name="models" id="models"></a>
            <h2 class="section">Generating Models</h2>
            <p>Database models are ESP classes that encapsulate database data and provide access methods. They
            provide a conduit to interact with the database. To generate a model:</p>
            <pre>
esp generate model MODEL [field:type ...]
</pre>
            <p>This will create a database model and will generate a model class under the <tt>models</tt> directory.
            It will also create a database migration to create a database table of the same name as the model.</p>
            <p>If <tt>field:type</tt> values are supplied, the database migration will include code to create a column
            for each specified field of the requested type. The valid database types are: binary, boolean, date,
            datetime, decimal, float, integer, number, string, text, time, timestamp. <a name="scaffolds" id=
            "scaffolds"></a></p>
            <h2 class="section">Generating Scaffolds</h2>
            <p>A scaffold is a generated database migration, database model, controller and a set of views that provide
            add, edit and list functionality for a database model. Scaffolds are useful to quickly generate prototype
            web pages and actions for managing a datbase table. To generate a scaffold:</p>
            <pre>
esp generate scaffold MODEL [field:type ...]
</pre>
            <p>This will create a scaffold for the database model and will generate a controller of the same name. If
            field:type values are supplied, the database migration will include code to create a database column for
            each specified field of the requested type. The valid database types are: binary, boolean, date, datetime,
            decimal, float, integer, number, string, text, time, timestamp. The scaffold will include an edit action
            and view page that provides add and edit capability. The list action and view, provides the ability to list
            the database table rows and select an entry to edit.</p>
            <p>You can use the --apply switch to apply the generated database migration and upgrade the
            database.</p><a name="migrations" id="migrations"></a>
            <h2 class="section">Generating Migrations</h2>
            <p>Database migrations are scripts which modify the database schema or content. You can create database
            migrations by the "<tt>esp generate migration</tt>" command. This command generates a migration for a
            specific model by creating or removing tables and columns. To generate a migration:</p>
            <pre>
esp generate migration description MODEL [field:type ...]
</pre>
            <p>This will create a migration script under the db/migrations directory. Migration scripts filenames are
            timestamped and use the description as part of the filename for the migration script (so keep it short and
            sweet).</p>
            <p>For each specified <tt>field:type</tt> pair, esp will generate add column code in the migration
            script. If the --reverse switch is specified, then remove column code will be generated. To change the type
            or name of a column, remove then re-add the column. <a name="runMigrations" id="runMigrations"></a></p>
            <h2 class="section">Running Migrations</h2>
            <p>Migration scripts can be run via the "<tt>esp migrate</tt>" command. Without other parameters, the
            command will run all migrations that have not yet been applied to the database. You can also use
            "<tt>esp migrate forward</tt>" to apply the next unapplied migration. Similarly, "<tt>esp migrate
            backward</tt>" will reverse the last applied migration. You can also use "<tt>esp migrate NNN</tt>" to
            migrate forward or backward to a specific migration. NNN is the migration sequence number which is the
            number at the start of the migration script file name.</p><a name="compiling" id="compiling"></a>
            <h2 class="section">Compiling</h2>
            <p>ESP compiles models, views and controllers into ESP byte code modules. These are then loaded
            and run by ESP in response to incoming client requests. Code is compiled only once but can be run many
            times to service incoming requests.</p>
            <p>In development mode, ESP will automatically compile the relevant portions of the application if the
            source code is modified. It can intelligently recompile views, actions, controllers and database models as
            required. However, you can also explicilty recompile portions or the complete application.</p>
            <h3>Compile Everything</h3>
            <p>Ejsweb can recompile everything via:</p>
            <pre>
esp compile ...
</pre>
            <p>This will compile each controller and view and also recompile the application and module source code.
            Module files for each component will be generated.</p>
            <h3>Compile Views and Controllers</h3>
            <p>Ejsweb also provides options for you to individually compile controllers and views. To recompile named
            views or controllers:</p>
            <pre>
esp compile view NAMES...
esp compile controller NAMES...
</pre>
            <p>When compiling views, you can use the <tt>--keep</tt> switch to preserve the intermediate generated
            ESP source file. This can sometimes be helpful for debugging.</p>
            <h3>Compile Models and Application Code</h3>
            <p>Models are compiled with application code into a single module file. To recompile the models and
            application source code:</p>
            <pre>
esp compile app
</pre>
            <h3>Compile Application as One Module</h3>
            <p>To compile the entire application and produce a single module file:</p>
            <pre>
esp compile all
</pre>
            <h3>Compile Stand-Alone Web Pages</h3>
            <p>To compile stand-alone ESP web pages:</p>
            <pre>
esp compile path/name.ejs...
</pre><a name="running" id="running"></a>
            <h2 class="section">Running</h2>
            <p>To run your application:</p>
            <pre>
esp run
</pre>
            <p>This requires that your config/config.ecf file be modified to define command to run your web
            server.</p><a name="cleaning" id="cleaning"></a>
            <h2 class="section">Cleaning</h2>
            <p>To clean all generated module files:</p>
            <pre>
esp clean
</pre><a name="options" id="options"></a>
            <h2 class="section">Command Options</h2>
            <p>Ejsweb has the following command usage patterns:</p>
            <pre>
esp clean
esp compile [all | app | controller names... | model names... | view names...]
esp compile path/name.ejs...
esp generate app name
esp generate controller name [actions...]
esp generate migration description model [field:type...]
esp generate model name
esp generate scaffold model [field:type ...]
esp migrate [forward|backward|NNN]
esp run
</pre>
            <table summary="" width="100%">
                <thead>
                    <tr>
                        <td>Switch</td>
                        <td>Description</td>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td nowrap="nowrap">--apply</td>
                        <td>Apply the database migration when generating a scaffold. This is the same as running
                        <tt>esp migrate</tt>.</td>
                    </tr>
                    <tr>
                        <td nowrap="nowrap">--database connector</td>
                        <td>Select a database connector to use. Currently, this switch is not implemented and sqlite is
                        the only connector supported.</td>
                    </tr>
                    <tr>
                        <td>--keep</td>
                        <td>Preserve generated intermediate ESP source files. These files are generated when
                        blending views with layout pages.</td>
                    </tr>
                    <tr>
                        <td>--layout layoutPage</td>
                        <td>Change the name of the default layout page if a view does not explicitly specify a layout
                        page.</td>
                    </tr>
                    <tr>
                        <td>--overwrite</td>
                        <td>Overwrite existing files. Ejsweb normally will not overwrite existing files. This is to
                        preserve user changes to previously generated files.</td>
                    </tr>
                    <tr>
                        <td>--reverse</td>
                        <td>Reverse the operation when generating a migration. Instead of adding tables or columns,
                        this switch will modify the migration to remove them.</td>
                    </tr>
                    <tr>
                        <td>--quiet or -q</td>
                        <td>Run quietly and don't trace actions to the console.</td>
                    </tr>
                    <tr>
                        <td>--verbose or -v</td>
                        <td>Run in verbose mode and trace actions to the console (default).</td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>
<!-- BeginDsi "dsi/bottom.html" -->

	<div class="bottom">
		<p class="footnote"> 
            <a href="../../../product/copyright.html" >&copy; Embedthis Software LLC, 2003-2011. 
            All rights reserved. Embedthis, ESP and Appweb are trademarks of Embedthis Software LLC.</a>
		</p>
	</div>
<!-- EndDsi -->
</body>
</html>
