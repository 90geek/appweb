<!-- BeginDsi "dsi/head.html" -->
<!DOCTYPE html>
<html lang="en">
<head>
    <title>Embedthis Appweb 4.0.0 Documentation</title>
    <meta name="keywords" content="embedded web server, web server software, embedded HTTP, application web server, 
        embedded server, small web server, HTTP server, library web server, library HTTP, HTTP library" />
    <meta name="description" content="Embedthis Sofware provides commercial and open source embedded web servers for 
        devices and applications." />
	<meta name="robots" content="index,follow" />
	<link href="../../../doc.css" rel="stylesheet" type="text/css" />
	<link href="../../../print.css" rel="stylesheet" type="text/css" media="print"/>
    <!--[if IE]>
    <link href="../../../iehacks.css" rel="stylesheet" type="text/css" />
    <![endif]-->
</head>

<body>
    <div class="top">
        <a class="logo" href="http://appwebserver.org/">&nbsp;</a>
        <div class="topRight">
             <div class="search">
                 <form method="get" action="http://www.google.com/search" title="Search appwebserver.org">
                     <p>
                        <label title="Search">Search</label> 
                        <input type="text" id="q" name="q" size="15" maxlength="255" />
                        <input type="submit" id="submit" value="Go" /> 
                        <input type="hidden" name="domains" value="appwebserver.org" /> 
                        <input type="hidden" name="sitesearch" value="appwebserver.org" />
                    </p>
                 </form>
              </div>
            <!--TITLE-->Embedthis Appweb 4.0.0
        </div>
        <div class="crumbs">
            <a href="../../../product/index.html">Home</a>
<!-- EndDsi -->
             &gt;<a href="index.html">ESP Guide</a>&gt; <b>Controllers and Actions</b>
        </div>
    </div>
    <div class="content">
        <div class="contentRight">
            <h2>Quick Nav</h2>
            <ul class="nav">
                <li><a href="#flow">Processing Flow</a></li>
                <li><a href="#routing">Routing Requests</a></li>
                <li><a href="#anatomy">Anatomy of a Controller</a></li>
                <li><a href="#actions">Actions</a></li>
                <li><a href="#context">Controller Context</a></li>
                <li><a href="#processing">Processing Requests</a></li>
                <li><a href="#models">Model Data</a></li>
                <li><a href="#forms">Form Data</a></li>
                <li><a href="#views">Rendering Views</a></li>
                <li><a href="#generating">Generating Controllers</a></li>
                <li><a href="#controller">Controller Class</a></li>
                <!-- <li><a href="#tips">Tips and Tricks</a></li> -->
            </ul>
<!-- BeginDsi "dsi/espSeeAlso.html" -->
		        <h2>See Also</h2>
		        <ul class="nav">
		          <li><a href="../../../../../../guide/appweb/esp/using.html">ESP Overview</a></li>
		          <li><a href="../../../../../../guide/appweb/esp/tour.html">ESP Tour</a></li>
		          <li><a href="../../../../../../guide/appweb/esp/template.html">Templates and Layouts</a></li>
		          <li><a href="../../../../../../guide/appweb/esp/controls.html">HTML Controls</a></li>
		          <li><a href="../../../../../../guide/appweb/esp/config.html">ESP Configuration Directives</a></li>
		          <li><a href="../../../../../../guide/appweb/esp/routing.html">ESP Routing and REST</a></li>
		          <li><a href="../../../../../../guide/appweb/esp/mvc.html">Model-View-Controller</a></li>
		          <li><a href="../../../../../../guide/appweb/esp/generator.html">Application Generator</a></li>
		          <li><a href="../../../../../../guide/appweb/esp/controllers.html">Controllers and Actions</a></li>
		          <li><a href="../../../../../../guide/appweb/esp/database.html">Database Interface</a></li>
		          <li><a href="../../../../../../guide/appweb/esp/caching.html">Caching Responses</a></li>
		        </ul>
<!-- EndDsi -->

            <ul>
                <li><a href="../../../api/esp.html">ESP Library</a></li>
            </ul>
        </div>
        <div class="contentLeft">
<pre>
- Process
    - Transparent compilation
    - Cache into cache directory
    - Can compile whole app
- Generator
- Rendering Data
    - Render data
        - finalize
    - Views
Async 
    - don't finalize
    - Auto finalize
API
Creating Routes
    - Cache Directory
    - EspKeepSource
    - Databases
    - URI links
</pre>
        <p>The ESP Model-view-controller (MVC) architecture is a pattern for designing well structured applications. 
        It separates the logic ("controller"), from the presentation ("view") and the application's data ("model"). 
        MVC applications have proven to be an effective organization for web applications. </p>

        <p>ESP <tt>controllers</tt> are the conductors of the application and they orchestrate the application's 
        activities. Via <tt>action</tt> functions, they receive client requests and generate appropriate responses, 
        mutating the applications data ("model") in the process.</p>
        <p>While controllers are most often used as part of an MVC application, they may also be used stand-alone.</p>

            <a name="routing" id="routing"></a>
            <h2 class="section">Routing Requests</h2>
            <p>When Appweb receives a client request, it examines each of the request routes configured in the appweb.conf
            configuration file, until it finds a matching route for the request URI. Routes will typically break 
            the URI into tokens and save the token values as request parameters. For request that will be serviced
            by a controller, one of these tokens will be the controller name.</p>

            <p>For example: one possible request URI format is:</p>
            <pre>
http://embedthis.com/APP/CONTROLLER/ACTION/ID
</pre>
            <p>Where <tt>APP</tt> is the (optional) name of the application, <tt>CONTROLLER</tt> is the controller
            name, <tt>ACTION</tt> is the name of the action method to run and <tt>ID</tt> is a selector for an element
            in the Model. When the request URI is parsed, the Appweb router will extract the controller name.</p>

            <h3>RESTful Routes</h3>
            <p>A RESTful approach to designing URI routes is also often used where different controller 
            actions are linked to specific routes. The end result being simple, readable URIs.</p>
<table>
    <thead>
<tr><td>Name</td><td>Method</td><td>Pattern</td><td>Action</td></tr>
    </thead>
    <tbody>
<tr><td>init</td><td>GET</td><td>/CONTROLLER/init$</td><td>init</td></tr>
<tr><td>create</td><td>POST</td><td>/CONTROLLER(/)*$</td><td>create</td></tr>
<tr><td>edit</td><td>GET</td><td>/CONTROLLER/edit$</td><td>edit</td></tr>
<tr><td>show</td><td>GET</td><td>/CONTROLLER$</td><td>show</td></tr>
<tr><td>update</td><td>PUT</td><td>/CONTROLLER$</td><td>update</td></tr>
<tr><td>destroy</td><td>DELETE</td><td>/CONTROLLER$</td><td>destroy</td></tr>
<tr><td>default</td><td>*</td><td>/CONTROLLER/{action}$</td><td>cmd-${action}</td></tr>
    </tbody>
</table>
            <p>In either case, RESTFul or not, the request URI is broken into tokens that specify the controller and 
            action to invoke to service the request. When a request is received, ESP will create an instance of the
            controller and invoke the requested action method.</p>

            <a name="flow" id="flow"></a>
            <h3>Processing Flow</h3>
            <p>Appweb processes requests in stages:</p>
            <ol>
                <li>Decode the URI and web request</li>
                <li>Route an incoming request to the request handler (ESP)</li>
                <li>If the request is for a web page, run that and render a response</li>
                <li>Otherwise if the request is routed to a controller, load the controller</li>
                <li>Run the specified controller action determined by the request route pattern</li>
                <li>Optionally render a response view to the client</li>
            </ol>

            
            <a name="anatomy" id="anatomy"></a>
            <h2 class="section">Anatomy of a Controller</h2>
            <p>So what does a controller look like? Here is a partial example that has four actions:</p>
            <a name="example" id="example"></a>
            <pre class="light">
#include "esp.h"

static void create() { 
    /* Create post here */
    redirect("list")
}
static void list() { }
}
static void edit() { 
    /* Create post here */
}
static void update() { 
    /* Update post here */
    renderView("post-edit");
}
ESP_EXPORT int esp_controller_post(HttpRoute *route, MprModule *module) 
{
    Edi     *edi;
    espDefineAction(route, "post-create", create);
    espDefineAction(route, "post-edit", edit);
    espDefineAction(route, "post-list", list);
    espDefineAction(route, "post-update", update);
    return 0;
}
</pre>
            <p>Now, say the client issues a request for:</p>
            <pre>
http://embedthis.com/app/post/create
</pre>
            <p>Assuming a correctly configured request route, the <tt>create</tt> action, in the <tt>post</tt>
            controller will be run. This will create a new blog post and then render the <tt>post-list.esp</tt> 
            view of posts back to the client.</p>
            <a name="config" id="config"></a>
            <h2 class="section">Configuring Controllers</h2>
            <p>Controllers may be configured two ways:
            <ul>
                <li>As part of an MVC application</li>
                <li>As a stand-alone controller function.</li>
            </ul>

            <h3>MVC Configuration</h3>
            <p>MVC applications are typically created via the <a href="generator.html"><tt>esp</tt></a> generator command.
            This command will create a bare MVC application with a directory for controllers, views and databases. It
            will also generate an <tt>appweb.conf</tt> configuration file to use when you run Appweb to host your
            application. By default, this configuration file will have an <tt>EspApp</tt> directive configured for your
            application. This directive creates a top level route for the MVC application and then a set of routes for
            each of the RESTful verbs: create, destroy, edit, list, show and update.</p>

            <pre>EspApp Prefix Dir RouteSet Database</pre>
            <p>The EspApp directive will create a set of routes that intercepts request URIs that begin with the given prefix
            and directs them toward the MVC application in the specified Directory. The RouteSet is typically 
            "<tt>restful</tt>" and lastly, an optional database may be pre-opened for the MVC application. For example:</p>
<pre>EspApp /store ./applications/store restful mdb://app/db/store.mdb</pre>

            <h3>Stand-Alone Controllers</h3>
            <p>Sometimes, you may wish to have a controller without a full MVC application. You can do this by using a
            set of Appweb directives.
            <pre>
&lt;Route ^/app/{controller}(/)*$>
    Name /app/*/list
    AddHandler espHandler
    EspDir controllers ./controllers
    Source test.c
    Target run $1-list
&lt;/Route>
</pre>
            <p>This set of directives will create a route that will invoke a controller in <tt>controllers/test.c</tt>.
            If the URI <tt>/app/test/</tt> is invoked, the <tt>list</tt> action function will be invoked in test.c.
            The EspDir directive nominates the directory to contain the controllers. By default this is configured to be
            DocumentRoot/controllers. The Target directive defines how the controller action function to invoke is
            determined. Note: This usage is less typical than using the MVC pattern.</p>

            <h2 class="section">

        EspApp /app app restful mdb://app/db/test.mdb

            <a name="actions" id="actions"></a>
            <h2 class="section">Actions</h2>
            <p>Actions are where the controller does its work. In ESP, actions are simple "C" functions.
            They need to be registered before use. This is done in the controller initialization function. This is the
            "<tt>esp_controller_post</tt>" function above. On the first time the controller is invoked, the controller
            library will be loaded and the initialization function will be run. Typically, this will then call
            <a href="../../../api/esp.html#group___esp_route_1ga321abe89cc91246b2a44f40493988670">espDefineAction</a> 
            to bind action functions to route actions.</p>

            <h3>Missing Actions</h3>
            <p>If the required action is not found, ESP will look for an action called "<tt>missing</tt>". If that is 
            not defined in the controller, it will look for a global "missing" function. Otherwise it will respond with
            a HTTP 404 error indicating that the required action could not be found.</p>
            
            <a name="processing" id="processing"></a>
            <h3>Processing the Request</h3>
            <p>The controller action can perform any processing it desires. There are no real restrictions except you don't
            want to block for too long without giving the client some feedback. Because Appweb is multithreaded, you can
            block. In that case, the server will continue to run and serve other requests. However, note that threads
            are a limited resource. It may be better to not block in the action, and use async programming techniques.</p>

            <h3>Async Processsing</h3>
            <p>An action function may return without completing the request. Normally, ESP will automatically finalize
            the request when the action returns. To prevent this, all 
            <a href="../../../api/esp.html#group___esp_abbrev_1ga9db9b8b7e2c750f6f942da0478866de2">
            <tt>dontAutoFinalize<tt></a> to tell ESP not to finalize the request and to keep the connection and
                response open. At anytime and from any other code, you may then call 
                <a href="../../../api/esp.html#group___esp_abbrev_1ga32d626626eee0bc4ade146973f6abb1c"><tt>finalize</tt></a>
                to complete the request.</p>
                <p>To force output to the client, without finalizing, use 
                <a
                    href="../../../api/esp.html#group___esp_abbrev_1ga32d626626eee0bc4ade146973f6abb1c"><tt>flush</tt></a>.

            <h2>Loading and Caching Controllers</h2>
            <p>For Appweb to use an ESP controller, it must first be compiled and linked into a loadable library.
            On Windows, this will be a DLL, on Unix, it will be a shared library with a ".so" extension. On VxWorks it
            will be a loadable task module.</p>

            <p>The compilation of controllers into libraries happens automatically if a compiler is installed on the
            system and if the "<tt>EspUpdate</tt> directive is enabled. If so, when a request is received, ESP will
            compile and link the controller in to a library and save the result into the ESP Cache directory for future
            use. After servicing the first request for the controller, the controller code is retained in memory and the
            controller will not be reloaded unless the source code is modified. If Appweb is rebooted, the cached
            library will be reloaded without recompiling. This provides a two-level caching: in-memory and on-disk as a
            shared library.</p>

            <h3>Development and Production Modes</h3>
            <p>When a request for a controller is received, ESP will test if the source code has been updated to
            determine if the controller must be recompiled. If the source has been changed, Appweb will wait for all
            requests using that controller to gracefully complete. When no requests are using the old controller
            version, Appweb will unload the controller, and ESP will recompile it into a new loadable module which will
            then be loaded and the request servicing resumed.</p>

            <p>If Appweb was configured and built in debug mode, the default value for EspUpdate will be enabled. If
            Appweb was built in release mode, the default value is off. In release mode is it common practice to lock
            down the compiled controllers and not auto-recompile in the field.</p>

            <a name="context" id="context"></a>

            <h2 class="section">Controller Context</h2>
            <p>ESP establishes a request context for the controller before invoking the action. The top level 
            of the context is represented by the <a href="../../../api/http.html#group___http_conn">HttpConn</a> 
            connection object. From this, all other request information can be reached, including:</p>
            <ul>
                <li>receive object &mdash; describes the client HTTP request.</li>
                <li>transmit object &mdash; describes the client HTTP response.</li>
                <li>host object &mdash; describes the web server hosting the application.</li>
                <li>params &mdash; request query, form, and routing parameters</li>
                <li>session state object &mdash; session state information.</li>
                <li>flash messages &mdash; informational messages to pass to the next action (and view)</li>
            </ul>

            <h3>ESP Short-Form API</h3>
            <p>When ESP invokes a controller action or a ESP web page, ESP defines the current HttpConn connection 
            object in Thread Local storage.  ESP also defines a terse, short-form, 
            <a href="../../../api/esp.html#group___esp_abbrev">API</a> that uses the current connection object to
            provide context for the API. When using this API, explicit access to the connection object should not be
            required. The ESP short-form API should cover 95% of requirements for action processing.</p>

            <h3>Explict Connection Access</h3>
            <p>If explicit access to the connection object is required, action functions may
            define a connection argument as <tt>action(HttpConn *conn)</tt> which is passed into all actions.
            Alternatively, the connection object can can be retrieved using the <a
                href="../../../api/esp.html#group___esp_abbrev_1gabe448b3542b4d1391e80e74192a09cb3>getConn">API</a>.</p>

            <h3>Navigating the Connection Object</h3>
            <p>The <a href="../../../api/http.html#group___http_conn">HttpConn</a> object represents the current
            TCP/IP connection. By using HTTP KeepAlive, the connection may be utilized for multiple requests. The fields
            of the HttpConn object are public and can be accessed and
            navigated.</p> 
            <table>
                <thead>
                    <tr><td>HttpConn Property</td><td>Purpose</td></tr>
                </thead>
                <tbody>
                    <tr><td>rx</td><td>Reference to the HttpRx receive object</td></tr>
                    <tr><td>tx</td><td>Reference to the HttpTx transmit object</td></tr>
                    <tr><td>host</td><td>Reference to the HttpHost object</td></tr>
                    <tr><td>http</td><td>Reference to the Http object</td></tr>
                    <tr><td>endpoint</td><td>Reference to the HttpEndpoint transmit object</td></tr>
                    <tr><td>limits</td><td>Reference to the HttpLimits object</td></tr>
                    <tr><td>ip</td><td>Remote client IP address</td></tr>
                    <tr><td>port</td><td>Remote client port</td></tr>
                </tbody>
            </table>

            <h3>Navigating the Receive Object</h3>
            <p>The <a href="../../../api/http.html#group___http_rx">HttpRx</a> object represents the receive side of the
            HTTP protocol. On the server, it holds state regarding the client HTTP request. The fields of the HttpRx
            object are public and can be accessed and navigated.</p> 
            <table>
                <thead>
                    <tr><td>HttpRx Property</td><td>Purpose</td></tr>
                </thead>
                <tbody>
                    <tr><td>method</td><td>HTTP request method</td></tr>
                    <tr><td>uri</td><td>Current URI (may be rewritten)</td></tr>
                    <tr><td>pathInfo</td><td>Path portion of the URI after the scriptName</td></tr>
                    <tr><td>scriptName</td><td>ScriptName portion of the URI</td></tr>
                    <tr><td>length</td><td>Content length</td></tr>
                    <tr><td>route</td><td>Reference to current HttpRoute object</td></tr>
                    <tr><td>params</td><td>Request params (query, form and route parameters)</td></tr>
                    <tr><td>files</td><td>Uploaded files</td></tr>
                </tbody>
            </table>

            <h3>Navigating the Tx Object</h3>
            <p>The <a href="../../../api/http.html#group___http_tx">HttpTx</a> object represents the transmit side of the
            HTTP protocol. On the server, it holds state regarding the response to the clientThe fields of the HttpTx
            object are public and can be accessed and navigated.</p> 
            <table>
                <thead>
                    <tr><td>HttpTx Property</td><td>Purpose</td></tr>
                </thead>
                <tbody>
                    <tr><td>filename</td><td>Name of the real file being served</td></tr>
                    <tr><td>ext</td><td>Filename extension</td></tr>
                    <tr><td>handler</td><td>Request handler object</td></tr>
                    <tr><td>length</td><td>Response content length</td></tr>
                    <tr><td>status</td><td>Response HTTP status</td></tr>
                    <tr><td>headers</td><td>Response HTTP headers</td></tr>
                </tbody>
            </table>

            
            <a name="models" id="models"></a>

            <h3>Sample of ESP API</h3>
            <p>Here are a few of the ESP APIs that may be used inside controller actions:</p>
            <table summary="viewClass" width="100%">
                <thead>
                    <tr>
                        <td nowrap="nowrap">Method / Property</td>
                        <td>Description</td>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><a href="../../../api/esp.html#group___esp_abbrev_1gadba1deb080e78b4517119a0294489b44">
                                addHeader</a></td> <td>Add a response HTTP header.</td>
                    </tr>
                    <tr>
                        <td><a href="../../../api/esp.html#group___esp_abbrev_1gab7b4049b554576b57f8cc49efc9e3a95">
                                createSession</a>
                        </td>
                        <td>Enable session control.</td>
                    </tr>
                    <tr>
                        <td><a href="../../../api/esp.html#group___esp_abbrev_1ga35677b9aa8d61543db5ea80377e823a6">
                            destroySession</a>
                        </td>
                        <td>Destroy a session.</td>
                    </tr>
                    <tr>
                        <td><a href="../../../api/esp.html#group___esp_abbrev_1ga9db9b8b7e2c750f6f942da0478866de2">
                                dontAutoFinalize</a>
                        </td>
                        <td>Don't automatically finalize output when the action returns. Useful for async actions.</td>
                    </tr>
                    <tr>
                        <td><a href="../../../api/esp.html#group___esp_abbrev_1ga03544bf56dde3a257391d07e1d6f6a3a">
                                error</a>
                        </td>
                        <td>Send an error flash message to the next web page.</td>
                    </tr>
                    <tr>
                        <td><a href="../../../api/esp.html#group___esp_abbrev_1ga8e8c0dccb4ded8a2fecec11d389cf8c8">
                                inform</a>
                        </td>
                        <td>Send an informational flash message to the next web page.</td>
                    </tr>
                    <tr>
                        <td><a href="../../../api/esp.html#group___esp_abbrev_1gad638c34898123293ebc120c1f9396a9c">
                            param</a>
                        </td>
                        <td>Get a request parameter value.</td>
                    </tr>
                    <tr>
                        <td><a href="../../../api/esp.html#group___esp_abbrev_1ga79cf206805a9595395af14e7c35f289d">
                                redirect</a></td>
                        <td>Redirect the client to a new URI.</td>
                    </tr>
                    <tr>
                        <td><a href="../../../api/esp.html#group___esp_abbrev_1gaf89154adc3cbf6d6a6a32c6b4457c593">
                                render</a></td>
                        <td>Render the text data back to the client.</td>
                    </tr>
                    <tr>
                        <td><a href="../../../api/esp.html#group___esp_abbrev_1gaa1e37f244a0e0796df494dfb756472a8">
                                renderFile</a></td>
                        <td>Render a file's contents back to the client.</td>
                    </tr>
                    <tr>
                        <td><a href="../../../api/esp.html#group___esp_abbrev_1gafe8d897ff436eabc6fc275f76222a5c3">
                                setContentType</a></td>
                        <td>Set the response content type.</td>
                    </tr>
                    <tr>
                        <td><a href="../../../api/esp.html#esp_8h_1a85b884db9ea1993efaa01dbe686f601c">
                                setCookie</a></td>
                        <td>Define a cookie to include in the response.</td>
                    </tr>
                    <tr>
                        <td><a href="../../../api/esp.html#group___esp_abbrev_1gadb4f7bc3020ab9c481f1ebcaf1ed3f2a">
                                setSessionVar</a></td>
                        <td>Set a variable in session state storage.</td>
                    </tr>
                    <tr>
                        <td><a href="../../../api/esp.html#group___esp_abbrev_1ga56d17d8860dc351f63feaa55891cdf21">
                                uri</a></td>
                        <td>Make a URI from parameters.</td>
                    </tr>
                </tbody>
            </table>

            <p>The controller can add to this context by declaring public variables in the controller class or the
            ApplicationController which is the base class for all controllers. Views can automatically access any such
            public controller variables.</p>
            
            <h2 class="section">Model Data</h2>
            <p>ESP provides an Object Relational Mapping (ORM) layer for accessing database data via convenient
            JavaScript objects. The ORM layer is a collection of database Model classes for the application.
            controllers use this layer to access the database via these Model classes. A typical paradigm is for action
            methods to read a database record and store the record in a public controller property. The view can then
            simply access the database data via this property.</p>
            <p>For more details, please see <a href="models.html">Database Models</a>.</p><a name="forms" id=
            "forms"></a>
            <h2 class="section">Form Data</h2>
            <p>HTTP Form data is marshalled by ESP into the <tt>params</tt> object which is accessible to actions.
            Each HTML input element posted by the client will become a property of <tt>params</tt>. ESP can also
            organize form data into nested objects. If an input element name contains a period, then ESP will
            create nested objects to match the input element name.</p><a name="views" id="views"></a>
            <h3>Rendering Views</h3>
            <p>After processing the request, the controller is responsible for rendering a view back to the client. If
            the action method does not explicitly render a view, ESP will look for a view with the same name as
            the action method.</p>
            <p>In the prior <a href="#example">example</a>, the <tt>edit</tt> action did not call any <tt>render</tt>
            function, so the framework will look for, and if found, run a view
            <tt>views/cart/edit.ejs</tt>.</p><a name="generating" id="generating"></a>
            <h2 class="section">Generating Controllers and Actions</h2>
            <p>ESP includes an an application generator, called <tt>esp</tt> to make it quick and easy to
            create controllers, actions and controller scaffolds. To generate a new controller, run:</p>
            <pre>
esp generate controller NAMES...
</pre>
            <p><tt>NAMES...</tt> are the names of the controllers you want to generate. This command will create
            controller source files under the <tt>controllers</tt> directory. Each controller will contain an empty
            controller class with an empty index action function. You can edit the controller source to meet your
            needs.</p>
            <p>When you create a controller, you can also (optionally) generate a set of named action functions. To
            generate actions when you create a controller, run:</p>
            <pre>
esp generate controller NAME ACTIONS...
</pre>
            <p>If <tt>ACTIONS</tt> are provided, action functions and views pages will be created for the given
            names.</p>
            <h3>Generating Scaffolds</h3>
            <p>A scaffold is a generated set of actions and views that provide add, edit, and list functionality for a
            database model. Scaffolds are useful to quickly generate prototype web pages and actions for managing a
            database table. To generate a scaffold:</p>
            <pre>
esp generate scaffold MODEL [field:type ...]
</pre>
            <p>When creating a scaffold for a database model, <tt>esp</tt> will create a database model, database
            migration, controller and edit and list view pages.</p>
            <p>If field:type pairs are supplied, the database migration will include code to create a column for each
            specified field of the requested type. The valid database types are: <tt>binary, boolean, date, datetime,
            decimal, float, integer, number, string, text, time, timestamp</tt>.</p>The scaffold will include an
            <tt>edit</tt> action and view that provides <tt>add</tt> and <tt>edit</tt> capability. The <tt>list</tt>
            action and view, provides the ability to list the database table rows and select an entry to edit. <a name=
            "controller" id="controller"></a>
            <h2 class="section">Controller Class</h2>
            <p>The Controller class has a large set of methods and properties. See the <a href=
            "../../../api/esp.html">ESP Library</a> for full details. Some of the more important
            properties:</p>
            <table summary="controllerProperties" width="100%">
                <thead>
                    <tr>
                        <td>Property</td>
                        <td>Description</td>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>actionName</td>
                        <td>Name of the action method being run.</td>
                    </tr>
                    <tr>
                        <td>application</td>
                        <td>Application global data.</td>
                    </tr>
                    <tr>
                        <td>controllerName</td>
                        <td>Name of the controller method being run.</td>
                    </tr>
                    <tr>
                        <td>flash</td>
                        <td>Lower case name of the controller.</td>
                    </tr>
                    <tr>
                        <td>flash</td>
                        <td>Flash message object for the next view.</td>
                    </tr>
                    <tr>
                        <td>host</td>
                        <td>HTTP host object.</td>
                    </tr>
                    <tr>
                        <td>params</td>
                        <td>Form parameters object.</td>
                    </tr>
                    <tr>
                        <td>request</td>
                        <td>HTTP request object.</td>
                    </tr>
                    <tr>
                        <td>response</td>
                        <td>HTTP response object.</td>
                    </tr>
                    <tr>
                        <td>session</td>
                        <td>Session state information.</td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>
<!-- BeginDsi "dsi/bottom.html" -->

	<div class="bottom">
		<p class="footnote"> 
            <a href="../../../product/copyright.html" >&copy; Embedthis Software LLC, 2003-2011. 
            All rights reserved. Embedthis, ESP, Ejscript and Appweb are trademarks of Embedthis Software LLC.</a>
		</p>
	</div>
<!-- EndDsi -->
</body>
</html>
